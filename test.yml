# Simple test file - this will trigger workflows

name: Simple Test
description: Ultra simple test that must run successfully

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Ultra Simple Test
      run: |
        echo "ðŸš€ Starting ultra simple test..."
        echo "Current time: $(date)"
        echo "Node version: $(node --version)"
        
        # Test WXpusher with most basic approach
        response=$(curl -s -X POST "https://wxpusher.zjiecode.com/api/send/message" \
          -H "Content-Type: application/json" \
          -d '{
            "appToken": "AT_MGRDCtFJyM0GSpNDL5Kx3veU7WVpc3nj",
            "content": "ðŸŽ¯ Ultra Simple Test SUCCESS!\n\nâ° Time: '"$(date)"'\nâœ… Status: Running\nðŸ”§ Token: AT_MGRDCtFJyM0GSpNDL5Kx3veU7WVpc3nj",
            "summary": "Simple Test Success",
            "contentType": 1,
            "uids": ["UID_Nkv98Q7XEQcDsvSInIlR10nm33xI"]
          }')
        
        echo "Response: $response"
        
        if echo "$response" | grep -q '"code":1000'; then
          echo "âœ… SUCCESS: WXpusher notification sent!"
          echo "## ðŸŽ‰ TEST RESULT: SUCCESS" >> $GITHUB_STEP_SUMMARY
          echo "- **Status**: âœ… SUCCESS" >> $GITHUB_STEP_SUMMARY
          echo "- **Time**: $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- **Response**: $response" >> $GITHUB_STEP_SUMMARY
          echo "- **You should receive notification on your phone!**" >> $GITHUB_STEP_SUMMARY
        else
          echo "âŒ FAILED: WXpusher notification failed"
          echo "## âŒ TEST RESULT: FAILED" >> $GITHUB_STEP_SUMMARY
          echo "- **Status**: âŒ FAILED" >> $GITHUB_STEP_SUMMARY
          echo "- **Time**: $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- **Response**: $response" >> $GITHUB_STEP_SUMMARY
          echo "- **Check**: AppToken, UID, API endpoint" >> $GITHUB_STEP_SUMMARY
          exit 1
        fi