name: Simple WXpusher Test Only

on:
  workflow_dispatch:
  schedule:
    # æ¯å°æ—¶æµ‹è¯•ä¸€æ¬¡
    - cron: '0 * * * *'

jobs:
  test-wxpusher:
    runs-on: ubuntu-latest
    
    steps:
    - name: Test WXpusher Direct API
      run: |
        echo "ðŸ§ª å¼€å§‹æµ‹è¯•WXpusher API..."
        echo "æ—¶é—´: $(date)"
        
        # å‘é€æµ‹è¯•æ¶ˆæ¯åˆ°WXpusher
        response=$(curl -s -X POST "https://wxpusher.zjiecode.com/api/send/message" \
          -H "Content-Type: application/json" \
          -d '{
            "appToken": "AT_MGRDCtFJyM0GSpNDL5Kx3veU7WVpc3nj",
            "content": "ðŸŽ¯ WXpusher APIæµ‹è¯•æˆåŠŸï¼\n\nâœ… è¿™æ˜¯æ¥è‡ªGitHub Actionsçš„ç›´æŽ¥APIæµ‹è¯•\nâ° æµ‹è¯•æ—¶é—´: '"$(date)"'\nðŸ”§ AppToken: AT_MGRDCtFJyM0GSpNDL5Kx3veU7WVpc3nj\nðŸ“± ç›®æ ‡UID: UID_Nkv98Q7XEQcDsvSInIlR10nm33xI",
            "summary": "WXpusher APIæµ‹è¯•",
            "contentType": 1,
            "uids": ["UID_Nkv98Q7XEQcDsvSInIlR10nm33xI"]
          }')
        
        echo "ðŸ“¡ APIå“åº”: $response"
        
        # è§£æžå“åº”æ£€æŸ¥çŠ¶æ€
        if echo "$response" | grep -q '"code":1000'; then
          echo "âœ… WXpusheré€šçŸ¥å‘é€æˆåŠŸï¼"
          echo "## ðŸŽ‰ WXpusher APIæµ‹è¯•ç»“æžœ" >> $GITHUB_STEP_SUMMARY
          echo "- **æµ‹è¯•æ—¶é—´**: $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- **AppToken**: AT_MGRDCtFJyM0GSpNDL5Kx3veU7WVpc3nj" >> $GITHUB_STEP_SUMMARY
          echo "- **ç›®æ ‡UID**: UID_Nkv98Q7XEQcDsvSInIlR10nm33xI" >> $GITHUB_STEP_SUMMARY
          echo "- **çŠ¶æ€**: âœ… æˆåŠŸå‘é€" >> $GITHUB_STEP_SUMMARY
          echo "- **å®Œæ•´å“åº”**: $response" >> $GITHUB_STEP_SUMMARY
        else
          echo "âŒ WXpusheré€šçŸ¥å‘é€å¤±è´¥ï¼"
          echo "## âŒ WXpusher APIæµ‹è¯•ç»“æžœ" >> $GITHUB_STEP_SUMMARY
          echo "- **æµ‹è¯•æ—¶é—´**: $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- **AppToken**: AT_MGRDCtFJyM0GSpNDL5Kx3veU7WVpc3nj" >> $GITHUB_STEP_SUMMARY
          echo "- **ç›®æ ‡UID**: UID_Nkv98Q7XEQcDsvSInIlR10nm33xI" >> $GITHUB_STEP_SUMMARY
          echo "- **çŠ¶æ€**: âŒ å‘é€å¤±è´¥" >> $GITHUB_STEP_SUMMARY
          echo "- **é”™è¯¯å“åº”**: $response" >> $GITHUB_STEP_SUMMARY
          exit 1
        fi